<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Selections · PDBTools.jl</title><meta name="title" content="Selections · PDBTools.jl"/><meta property="og:title" content="Selections · PDBTools.jl"/><meta property="twitter:title" content="Selections · PDBTools.jl"/><meta name="description" content="Documentation for PDBTools.jl."/><meta property="og:description" content="Documentation for PDBTools.jl."/><meta property="twitter:description" content="Documentation for PDBTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PDBTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PDBTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../readwrite/">Read and Write</a></li><li class="is-active"><a class="tocitem" href>Selections</a><ul class="internal"><li><a class="tocitem" href="#General-selection-syntax"><span>General selection syntax</span></a></li><li><a class="tocitem" href="#Special-macros:-proteins,-water"><span>Special macros: proteins, water</span></a></li><li><a class="tocitem" href="#Retrieving-indices,-filtering,-etc"><span>Retrieving indices, filtering, etc</span></a></li><li><a class="tocitem" href="#Use-Julia-functions-directly"><span>Use Julia functions directly</span></a></li><li><a class="tocitem" href="#Iterate-over-residues-(or-molecules)"><span>Iterate over residues (or molecules)</span></a></li><li><a class="tocitem" href="#Using-VMD"><span>Using VMD</span></a></li></ul></li><li><a class="tocitem" href="../elements/">Element properties</a></li><li><a class="tocitem" href="../auxiliary/">Auxiliary functions</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../help/">Help entries</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Selections</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Selections</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/PDBTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/PDBTools.jl/blob/main/docs/src/selections.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="selections"><a class="docs-heading-anchor" href="#selections">Selection functions</a><a id="selections-1"></a><a class="docs-heading-anchor-permalink" href="#selections" title="Permalink"></a></h1><p>The <code>select</code> function can be used to select subsets of atoms from a vector of atoms. A simple selection syntax can be used, for example: </p><pre><code class="language-julia hljs">atoms = select(atoms, &quot;protein and resnum &lt; 30&quot;)</code></pre><p>or standard Julia function can be provided as the second argument:</p><pre><code class="language-julia hljs">atoms = select(atoms, at -&gt; isprotein(at) &amp;&amp; resnum(at) &lt; 30)</code></pre><h2 id="General-selection-syntax"><a class="docs-heading-anchor" href="#General-selection-syntax">General selection syntax</a><a id="General-selection-syntax-1"></a><a class="docs-heading-anchor-permalink" href="#General-selection-syntax" title="Permalink"></a></h2><p>Accepted Boolean operators: <code>and</code>, <code>or</code>, and <code>not</code>. </p><p>The accepted keywords for the selection are: </p><table><tr><th style="text-align: center">Keyword</th><th style="text-align: center">Options</th><th style="text-align: center">Input value</th><th style="text-align: center">Example</th></tr><tr><td style="text-align: center"><code>index</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>index &lt;= 10</code></td></tr><tr><td style="text-align: center"><code>index_pdb</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>index_pdb &lt;= 10</code></td></tr><tr><td style="text-align: center"><code>name</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>name CA</code></td></tr><tr><td style="text-align: center"><code>element</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>element N</code></td></tr><tr><td style="text-align: center"><code>resname</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>resname ALA</code></td></tr><tr><td style="text-align: center"><code>resnum</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>resnum = 10</code></td></tr><tr><td style="text-align: center"><code>residue</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>residue = 10</code></td></tr><tr><td style="text-align: center"><code>chain</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>chain A</code></td></tr><tr><td style="text-align: center"><code>model</code></td><td style="text-align: center"></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>model 1</code></td></tr><tr><td style="text-align: center"><code>beta</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>beta &gt; 0.5</code></td></tr><tr><td style="text-align: center"><code>occup</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>occup &gt;= 0.3</code></td></tr><tr><td style="text-align: center"><code>segname</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>segname PROT</code></td></tr><tr><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>resnum</code> is the residue number as written in the PDB file, while <code>residue</code> is the residue number counted sequentially in the file.</p><p><code>index_pdb</code> is the number written in the &quot;atom index&quot; field of the PDB file, while <code>index</code> is the sequential index of the atom in the file. </p></div></div><h2 id="Special-macros:-proteins,-water"><a class="docs-heading-anchor" href="#Special-macros:-proteins,-water">Special macros: proteins, water</a><a id="Special-macros:-proteins,-water-1"></a><a class="docs-heading-anchor-permalink" href="#Special-macros:-proteins,-water" title="Permalink"></a></h2><p>Just use these keywords to select the residues matching the properties desired. </p><p>Examples:</p><pre><code class="language-julia hljs">aromatic = select(atoms,&quot;aromatic&quot;)
</code></pre><pre><code class="language-julia hljs">aromatic = select(atoms,&quot;charged&quot;)
</code></pre><p>Available keywords:</p><table><tr><th style="text-align: center">Keywords</th><th style="text-align: center"></th><th style="text-align: center"></th></tr><tr><td style="text-align: center"><code>water</code></td><td style="text-align: center"></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>protein</code></td><td style="text-align: center"><code>backbone</code></td><td style="text-align: center"><code>sidechain</code></td></tr><tr><td style="text-align: center"><code>acidic</code></td><td style="text-align: center"><code>basic</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>aliphatic</code></td><td style="text-align: center"><code>aromatic</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>charged</code></td><td style="text-align: center"><code>neutral</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>polar</code></td><td style="text-align: center"><code>nonpolar</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>hydrophobic</code></td><td style="text-align: center"></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr></table><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The properties refer to protein residues and will return <code>false</code> to every non-protein residue. Thus, be careful with the use of <code>not</code> with these selections, as they might retrieve non-protein atoms.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.select" href="#PDBTools.select"><code>PDBTools.select</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select(atoms::AbstractVector{&lt;:Atom}, by::String)</code></pre><p>Selects atoms from a vector of atoms using a string query, or a function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/select.jl#L86-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.Select" href="#PDBTools.Select"><code>PDBTools.Select</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Select</code></pre><p>This structure acts a function when used within typical julia filtering functions,  by converting a string selection into a call to query call. </p><p><strong>Example</strong></p><p>Using a string to select the CA atoms of the first residue:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein&quot;);

julia&gt; findfirst(Select(&quot;name CA&quot;), atoms)
5

julia&gt; filter(Select(&quot;name CA and residue 1&quot;), atoms)
   Vector{Atom{Nothing}} with 1 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       5   CA     ALA     A        1        1   -8.483  -14.912   -6.726  1.00  0.00     1    PROT         5
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/select.jl#L10-L35">source</a></section></article><h2 id="Retrieving-indices,-filtering,-etc"><a class="docs-heading-anchor" href="#Retrieving-indices,-filtering,-etc">Retrieving indices, filtering, etc</a><a id="Retrieving-indices,-filtering,-etc-1"></a><a class="docs-heading-anchor-permalink" href="#Retrieving-indices,-filtering,-etc" title="Permalink"></a></h2><p>If only the indices of the atoms are of interest, the Julia <code>findall</code> function can be used, by passing a <code>Select</code> object, or a regular  function, to select the atoms:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein and residue &lt;= 3&quot;);

julia&gt; findall(Select(&quot;name CA&quot;), atoms)
3-element Vector{Int64}:
  5
 15
 26

julia&gt; findall(at -&gt; name(at) == &quot;CA&quot;, atoms)
3-element Vector{Int64}:
  5
 15
 26</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All indexing is 1-based. Thus, the first atom of the structure is atom 1.</p></div></div><p>The <code>Select</code> constructor can be used to feed simple selection syntax entries to  other Julia functions, such as <code>findfirst</code>, <code>findlast</code>, or <code>filter</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein and residue &lt;= 3&quot;);

julia&gt; filter(Select(&quot;name CA&quot;), atoms)
   Vector{Atom{Nothing}} with 3 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       5   CA     ALA     A        1        1   -8.483  -14.912   -6.726  1.00  0.00     1    PROT         5
      15   CA     CYS     A        2        2   -5.113  -13.737   -5.466  1.00  0.00     1    PROT        15
      26   CA     ASP     A        3        3   -3.903  -11.262   -8.062  1.00  0.00     1    PROT        26

julia&gt; findfirst(Select(&quot;beta = 0.00&quot;), atoms)
1</code></pre><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>The <code>sel&quot;&quot;</code> literal string macro is a shortcut for <code>Select</code>. Thus, these syntaxes are valid:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein and residue &lt;= 3&quot;);

julia&gt; name.(filter(sel&quot;name CA&quot;, atoms))
3-element Vector{InlineStrings.String7}:
 &quot;CA&quot;
 &quot;CA&quot;
 &quot;CA&quot;

julia&gt; findfirst(sel&quot;name CA&quot;, atoms)
5</code></pre></div></div><h2 id="Use-Julia-functions-directly"><a class="docs-heading-anchor" href="#Use-Julia-functions-directly">Use Julia functions directly</a><a id="Use-Julia-functions-directly-1"></a><a class="docs-heading-anchor-permalink" href="#Use-Julia-functions-directly" title="Permalink"></a></h2><p>Selections can be done using Julia functions directly, providing a greater control over the selection and, possibly, the use of user defined selection  functions. For example:</p><pre><code class="language-julia hljs">myselection(atom) = (atom.x &lt; 10.0 &amp;&amp; atom.resname == &quot;GLY&quot;) || (atom.name == &quot;CA&quot;) 
atoms = select(atoms, myselection)</code></pre><p>or, for example, using Julia anonymous functions</p><pre><code class="language-julia hljs">select(atoms, at -&gt; isprotein(at) &amp;&amp; name(at) == &quot;O&quot; &amp;&amp; atom.x &lt; 10.0)</code></pre><p>The only requirement is that the function defining the selection receives an <code>PDBTools.Atom</code> as input, and returns <code>true</code> or <code>false</code> depending on the conditions required for the atom.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The macro-keywords described in the previous section can be used within  the Julia function syntax, but the function names start with <code>is</code>. For example:</p><pre><code class="language-julia hljs">select(atoms, at -&gt; isprotein(at) &amp;&amp; resnum(at) in [ 1, 5, 7 ])</code></pre><p>Thus, the macro selection functions are: <code>iswater</code>,  <code>isprotein</code>,     <code>isbackbone</code>,    <code>issidechain</code>, <code>isacidic</code>,      <code>isbasic</code>,                   <code>isaliphatic</code>,   <code>isaromatic</code>,                <code>ischarged</code>,     <code>isneutral</code>,                 <code>ispolar</code>,       <code>isnonpolar</code>,                and <code>ishydrophobic</code>.                          </p></div></div><h2 id="Iterate-over-residues-(or-molecules)"><a class="docs-heading-anchor" href="#Iterate-over-residues-(or-molecules)">Iterate over residues (or molecules)</a><a id="Iterate-over-residues-(or-molecules)-1"></a><a class="docs-heading-anchor-permalink" href="#Iterate-over-residues-(or-molecules)" title="Permalink"></a></h2><p>The <code>eachresidue</code> iterator allows iteration over the resiudes of a structure (in PDB files distinct molecules are associated to different residues, thus this iterates similarly over the molecules of a structure). For example:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; protein = read_pdb(PDBTools.SMALLPDB);

julia&gt; count(atom -&gt; resname(atom) == &quot;ALA&quot;, protein)
12

julia&gt; count(res -&gt; resname(res) == &quot;ALA&quot;, eachresidue(protein))
1</code></pre><p>The result of the iterator can also be collected, with:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; protein = read_pdb(PDBTools.SMALLPDB);

julia&gt; residues = collect(eachresidue(protein))
   Vector{Residue} with 3 residues.

julia&gt; residues[1]
 Residue of name ALA with 12 atoms.
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       1    N     ALA     A        1        1   -9.229  -14.861   -5.481  0.00  0.00     1    PROT         1
       2 1HT1     ALA     A        1        1  -10.048  -15.427   -5.569  0.00  0.00     1    PROT         2
       3  HT2     ALA     A        1        1   -9.488  -13.913   -5.295  0.00  0.00     1    PROT         3
                                                       ⋮
      10  HB3     ALA     A        1        1   -9.164  -15.063   -8.765  1.00  0.00     1    PROT        10
      11    C     ALA     A        1        1   -7.227  -14.047   -6.599  1.00  0.00     1    PROT        11
      12    O     ALA     A        1        1   -7.083  -13.048   -7.303  1.00  0.00     1    PROT        12</code></pre><p>These residue vector <em>do not</em> copy the data from the original atom vector. Therefore, changes performed on these vectors will be reflected on the original data.  </p><p>It is possible also to iterate over the atoms of one or more residue:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; protein = read_pdb(PDBTools.SMALLPDB);

julia&gt; m_ALA = 0.
       for residue in eachresidue(protein)
         if name(residue) == &quot;ALA&quot;
           for atom in residue
             m_ALA += mass(atom)
           end
         end
       end
       m_ALA
73.09488999999999</code></pre><p>Which, in this simple example, results in the same as:</p><pre><code class="language-julia-repl hljs">julia&gt; sum(mass(at) for at in protein if resname(at) == &quot;ALA&quot; )
73.09488999999999</code></pre><p>or</p><pre><code class="language-julia-repl hljs">julia&gt; sum(mass(res) for res in eachresidue(protein) if resname(res) == &quot;ALA&quot; )
73.09488999999999</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.Residue" href="#PDBTools.Residue"><code>PDBTools.Residue</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Residue(atoms::AbstractVector{&lt;:Atom}, range::UnitRange{Int})</code></pre><p>Residue data structure. It contains two fields: <code>atoms</code> which is a vector of <code>Atom</code> elements, and <code>range</code>, which indicates which atoms of the <code>atoms</code> vector compose the residue.</p><p>The Residue structure carries the properties of the residue or molecule of the atoms it contains, but it does not copy the original vector of atoms, only the residue meta data for each residue.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; pdb = wget(&quot;1LBD&quot;);

julia&gt; residues = collect(eachresidue(pdb))
   Vector{Residue} with 238 residues.

julia&gt; resnum.(residues[1:3])
3-element Vector{Int32}:
 225
 226
 227

julia&gt; residues[5].chain
&quot;A&quot;

julia&gt; residues[8].range
52:58
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/Residue.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.eachresidue" href="#PDBTools.eachresidue"><code>PDBTools.eachresidue</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachresidue(atoms::AbstractVector{&lt;:Atom})</code></pre><p>Iterator for the residues (or molecules) of a selection. </p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; atoms = wget(&quot;1LBD&quot;);

julia&gt; length(eachresidue(atoms))
238

julia&gt; for res in eachresidue(atoms)
         println(res)
       end
 Residue of name SER with 6 atoms.
   index name resname chain   resnum  residue        x        y        z  beta occup model segname index_pdb
       1    N     SER     A      225        1   45.228   84.358   70.638 67.05  1.00     1       -         1
       2   CA     SER     A      225        1   46.080   83.165   70.327 68.73  1.00     1       -         2
       3    C     SER     A      225        1   45.257   81.872   70.236 67.90  1.00     1       -         3
       4    O     SER     A      225        1   45.823   80.796   69.974 64.85  1.00     1       -         4
       5   CB     SER     A      225        1   47.147   82.980   71.413 70.79  1.00     1       -         5
       6   OG     SER     A      225        1   46.541   82.639   72.662 73.55  1.00     1       -         6

 Residue of name ALA with 5 atoms.
   index name resname chain   resnum  residue        x        y        z  beta occup model segname index_pdb
       7    N     ALA     A      226        2   43.940   81.982   70.474 67.09  1.00     1       -         7
       8   CA     ALA     A      226        2   43.020   80.825   70.455 63.69  1.00     1       -         8
       9    C     ALA     A      226        2   41.996   80.878   69.340 59.69  1.00     1       -         9
                                                      ...
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/Residue.jl#L96-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.resname" href="#PDBTools.resname"><code>PDBTools.resname</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">resname(residue::Union{AbstractString,Char})</code></pre><p>Returns the residue name, given the one-letter code or residue name. Differently from <code>threeletter</code>, this function will return the force-field name if available in the list of protein residues.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; resname(&quot;ALA&quot;)
&quot;ALA&quot;

julia&gt; resname(&quot;GLUP&quot;)
&quot;GLUP&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/protein_residues.jl#L147-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.residuename" href="#PDBTools.residuename"><code>PDBTools.residuename</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">residuename(residue::Union{AbstractString,Char})</code></pre><p>Function to return the long residue name from other residue codes. The function is case-insensitive.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; residuename(&quot;A&quot;)
&quot;Alanine&quot;

julia&gt; residuename(&quot;Glu&quot;)
&quot;Glutamic Acid&quot;
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/protein_residues.jl#L182-L198">source</a></section></article><h2 id="Using-VMD"><a class="docs-heading-anchor" href="#Using-VMD">Using VMD</a><a id="Using-VMD-1"></a><a class="docs-heading-anchor-permalink" href="#Using-VMD" title="Permalink"></a></h2><p><a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> is a very popular and powerful package for visualization of simulations. It contains a very versatile library to read topologies and trajectory files, and a powerful selection syntax. We provide here a wrapper to VMD which allows using its capabilities.  </p><p>For example, the solute can be defined with: </p><pre><code class="language-julia hljs">indices, names = select_with_vmd(&quot;./system.gro&quot;,&quot;protein&quot;,vmd=&quot;/usr/bin/vmd&quot;)</code></pre><p>The output will contain two lists, one of atom indices (one-based) and atom names. The indices correspond to sequential indices in the input, <em>not</em> the indices written in the PDB file, for example.</p><p>The input may also be a vector of atoms of type <code>PDBTools.Atom</code>:</p><pre><code class="language-julia hljs">atoms = read_pdb(&quot;mypdbfile.pdb&quot;)
indices, names = select_with_vmd(atoms,&quot;protein&quot;,vmd=&quot;/usr/bin/vmd&quot;)</code></pre><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>If <code>vmd</code> is available in your path, there is no need to pass it as a keyword parameter.</p></div></div><p>The main advantage here is that all the file types and the complete selection syntax  that VMD supports are supported. But VMD needs to be installed and is run in background, and it takes a few seconds to run.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.select_with_vmd" href="#PDBTools.select_with_vmd"><code>PDBTools.select_with_vmd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select_with_vmd(inputfile::String, selection::String; vmd=&quot;vmd&quot;, srcload=nothing)
select_with_vmd(atoms::AbstractVector{&lt;:Atom}, selection::String; vmd=&quot;vmd&quot;, srcload=nothing)</code></pre><p>Select atoms using vmd selection syntax, with vmd in background. The input can be a file or a list of atoms.</p><p>Returns a tuple with list of index (one-based) and atom names of the selection.</p><p>Function to return the selection from a input file (topology, coordinates, etc),  by calling VMD in the background.</p><p>The <code>srcload</code> argument can be used to load a list of scripts before loading the input file, for example with macros to define custom selection keywords.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/04dcefa1a2a3d68a0de135ee4bb751b0b469b493/src/select_with_vmd.jl#L1-L16">source</a></section></article><h3 id="Loading-vmd-scripts"><a class="docs-heading-anchor" href="#Loading-vmd-scripts">Loading vmd scripts</a><a id="Loading-vmd-scripts-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-vmd-scripts" title="Permalink"></a></h3><p>The <code>select_with_vmd</code> function also accepts an optional keyword parameter <code>srcload</code>, which can be used to load custom scripts within <code>vmd</code> before running setting the selection. This allows the definition of <code>tcl</code> scripts with custom selection macros, for instance. The usage would be: </p><pre><code class="language-julia hljs">sel = select_with_vmd(&quot;file.pdb&quot;, &quot;resname MYRES&quot;; srcload = [ &quot;mymacros1.tcl&quot;, &quot;mymacros2.tcl&quot; ])</code></pre><p>Which corresponds to <code>source</code>ing each of the macro files in VMD before defining the  selection with the custom <code>MYRES</code> name.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>VMD uses 0-based indexing and <code>select_with_vmd</code> adjusts that. However, if a selection is performed by index, as with <code>index 1</code>, VMD will select the second atom, and the output will be <code>[2]</code>. Selections by type, name, segment, residue name, etc, will be consistent with one-based indexing.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../readwrite/">« Read and Write</a><a class="docs-footer-nextpage" href="../elements/">Element properties »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 17 February 2025 19:34">Monday 17 February 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
