<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Selections · PDBTools.jl</title><meta name="title" content="Selections · PDBTools.jl"/><meta property="og:title" content="Selections · PDBTools.jl"/><meta property="twitter:title" content="Selections · PDBTools.jl"/><meta name="description" content="Documentation for PDBTools.jl."/><meta property="og:description" content="Documentation for PDBTools.jl."/><meta property="twitter:description" content="Documentation for PDBTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PDBTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PDBTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../readwrite/">Read and Write</a></li><li class="is-active"><a class="tocitem" href>Selections</a><ul class="internal"><li><a class="tocitem" href="#General-selection-syntax"><span>General selection syntax</span></a></li><li><a class="tocitem" href="#Special-macros:-proteins,-water"><span>Special macros: proteins, water</span></a></li><li><a class="tocitem" href="#Retrieving-indices,-filtering,-etc"><span>Retrieving indices, filtering, etc</span></a></li><li><a class="tocitem" href="#Use-Julia-functions-directly"><span>Use Julia functions directly</span></a></li><li><a class="tocitem" href="#Using-VMD"><span>Using VMD</span></a></li></ul></li><li><a class="tocitem" href="../iterators/">Iterators</a></li><li><a class="tocitem" href="../elements/">Atom and element properties</a></li><li><a class="tocitem" href="../contacts/">Contact maps</a></li><li><a class="tocitem" href="../dihedrals/">Dihderals and Ramachandran</a></li><li><a class="tocitem" href="../hydrogen_bonds/">Hydrogen bonds</a></li><li><a class="tocitem" href="../sasa/">Solvent Accessible Area</a></li><li><a class="tocitem" href="../auxiliary/">Auxiliary functions</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../help/">Help entries</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Selections</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Selections</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/PDBTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/PDBTools.jl/blob/main/docs/src/selections.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="selections"><a class="docs-heading-anchor" href="#selections">Selection functions</a><a id="selections-1"></a><a class="docs-heading-anchor-permalink" href="#selections" title="Permalink"></a></h1><p>The <code>select</code> function can be used to select subsets of atoms from a vector of atoms. A simple selection syntax can be used, for example: </p><pre><code class="language-julia hljs">atoms = select(atoms, &quot;protein and resnum &lt; 30&quot;)</code></pre><p>or standard Julia function can be provided as the second argument:</p><pre><code class="language-julia hljs">atoms = select(atoms, at -&gt; isprotein(at) &amp;&amp; resnum(at) &lt; 30)</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.select" href="#PDBTools.select"><code>PDBTools.select</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select(atoms::AbstractVector{&lt;:Atom}, selection_string::String)
select(atoms::AbstractVector{&lt;:Atom}, selection_function::Function)</code></pre><p>Selects atoms from a vector of atoms using a string query, or a function.</p><p>The string query can be a simple selection like <code>&quot;name CA&quot;</code> or a more complex one like <code>&quot;name CA or (residue 1 2 3)&quot;</code>. The function can be any function that takes an atom and returns a boolean value.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein&quot;);

julia&gt; select(atoms, &quot;name CA and (residue &gt; 1 and residue &lt; 3)&quot;)
   Vector{Atom{Nothing}} with 1 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
      15   CA     CYS     A        2        2   -5.113  -13.737   -5.466  1.00  0.00     1    PROT        15

julia&gt; select(atoms, at -&gt; name(at) == &quot;CA&quot; &amp;&amp; 1 &lt; residue(at) &lt; 3)
   Vector{Atom{Nothing}} with 1 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
      15   CA     CYS     A        2        2   -5.113  -13.737   -5.466  1.00  0.00     1    PROT        15  
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/1a8fc23ecd0484965087d88354666a2f358b3468/src/select/select.jl#L84-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.Select" href="#PDBTools.Select"><code>PDBTools.Select</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Select</code></pre><p>This structure acts a function when used within typical julia filtering functions,  by converting a string selection into a call to query call. </p><p><strong>Example</strong></p><p>Using a string to select the CA atoms of the first residue:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein&quot;);

julia&gt; findfirst(Select(&quot;name CA&quot;), atoms)
5

julia&gt; filter(Select(&quot;name CA and residue 1&quot;), atoms)
   Vector{Atom{Nothing}} with 1 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       5   CA     ALA     A        1        1   -8.483  -14.912   -6.726  1.00  0.00     1    PROT         5
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/1a8fc23ecd0484965087d88354666a2f358b3468/src/select/select.jl#L8-L33">source</a></section></article><h2 id="General-selection-syntax"><a class="docs-heading-anchor" href="#General-selection-syntax">General selection syntax</a><a id="General-selection-syntax-1"></a><a class="docs-heading-anchor-permalink" href="#General-selection-syntax" title="Permalink"></a></h2><ul><li>Accepted Boolean operators: <code>and</code>, <code>or</code>, and <code>not</code>. </li><li>Accepted comparison operators: <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>=&gt;</code>, <code>==</code></li><li>Support for parenthesis. </li><li>Support for multiple keys as a shorcut for multiple <code>or</code> (i. e. <code>residue 1 3 5</code>)</li></ul><div class="admonition is-compat" id="Compat-d98fa80a7bd42a5c"><header class="admonition-header">Compat<a class="admonition-anchor" href="#Compat-d98fa80a7bd42a5c" title="Permalink"></a></header><div class="admonition-body"><ul><li>Support for selection strings supporting parenthesis and multiple keys was introduced in v3.1.0</li><li>Support for selection by coordinates, <code>x</code>, <code>y</code>, and <code>z</code> was introduced in v3.2.0</li></ul></div></div><p>The accepted keywords for the selection are: </p><table><tr><th style="text-align: center">Keyword</th><th style="text-align: center">Options</th><th style="text-align: center">Input value</th><th style="text-align: center">Example</th></tr><tr><td style="text-align: center"><code>index</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>index &lt;= 10</code></td></tr><tr><td style="text-align: center"><code>index_pdb</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>index_pdb &lt;= 10</code></td></tr><tr><td style="text-align: center"><code>name</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>name CA</code></td></tr><tr><td style="text-align: center"><code>element</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>element N</code></td></tr><tr><td style="text-align: center"><code>resname</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>resname ALA</code></td></tr><tr><td style="text-align: center"><code>resnum</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>resnum = 10</code></td></tr><tr><td style="text-align: center"><code>residue</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>residue = 10</code></td></tr><tr><td style="text-align: center"><code>chain</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>chain A</code></td></tr><tr><td style="text-align: center"><code>model</code></td><td style="text-align: center"></td><td style="text-align: center">Integer</td><td style="text-align: center"><code>model 1</code></td></tr><tr><td style="text-align: center"><code>beta</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>beta &gt; 0.5</code></td></tr><tr><td style="text-align: center"><code>occup</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>occup &gt;= 0.3</code></td></tr><tr><td style="text-align: center"><code>segname</code></td><td style="text-align: center"></td><td style="text-align: center">String</td><td style="text-align: center"><code>segname PROT</code></td></tr><tr><td style="text-align: center"><code>x</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>x &gt;= 3.0</code></td></tr><tr><td style="text-align: center"><code>y</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>y &lt; 0.0</code></td></tr><tr><td style="text-align: center"><code>z</code></td><td style="text-align: center"><code>=</code>,<code>&gt;</code>,<code>&lt;</code>,<code>&lt;=</code>,<code>&gt;=</code></td><td style="text-align: center">Real</td><td style="text-align: center"><code>z &gt;= 1.0</code></td></tr><tr><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr></table><div class="admonition is-info" id="Note-a2a7d94ce52162e6"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-a2a7d94ce52162e6" title="Permalink"></a></header><div class="admonition-body"><p><code>resnum</code> is the residue number as written in the PDB file, while <code>residue</code> is the residue number counted sequentially in the file.</p><p><code>index_pdb</code> is the number written in the &quot;atom index&quot; field of the PDB file, while <code>index</code> is the sequential index of the atom in the file. </p></div></div><h2 id="Special-macros:-proteins,-water"><a class="docs-heading-anchor" href="#Special-macros:-proteins,-water">Special macros: proteins, water</a><a id="Special-macros:-proteins,-water-1"></a><a class="docs-heading-anchor-permalink" href="#Special-macros:-proteins,-water" title="Permalink"></a></h2><p>Just use these keywords to select the residues matching the properties desired. </p><p>Examples:</p><pre><code class="language-julia hljs">aromatic = select(atoms,&quot;aromatic&quot;)
</code></pre><pre><code class="language-julia hljs">aromatic = select(atoms,&quot;charged&quot;)
</code></pre><p>Available keywords:</p><table><tr><th style="text-align: center">Keywords</th><th style="text-align: center"></th><th style="text-align: center"></th></tr><tr><td style="text-align: center"><code>water</code></td><td style="text-align: center"></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>protein</code></td><td style="text-align: center"><code>backbone</code></td><td style="text-align: center"><code>sidechain</code></td></tr><tr><td style="text-align: center"><code>acidic</code></td><td style="text-align: center"><code>basic</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>aliphatic</code></td><td style="text-align: center"><code>aromatic</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>charged</code></td><td style="text-align: center"><code>neutral</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>polar</code></td><td style="text-align: center"><code>nonpolar</code></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"><code>hydrophobic</code></td><td style="text-align: center"></td><td style="text-align: center"></td></tr><tr><td style="text-align: center"></td><td style="text-align: center"></td><td style="text-align: center"></td></tr></table><div class="admonition is-info" id="Note-4e50e5a00f325dc"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-4e50e5a00f325dc" title="Permalink"></a></header><div class="admonition-body"><p>The properties refer to protein residues and will return <code>false</code> to every non-protein residue. Thus, be careful with the use of <code>not</code> with these selections, as they might retrieve non-protein atoms.</p></div></div><h2 id="Retrieving-indices,-filtering,-etc"><a class="docs-heading-anchor" href="#Retrieving-indices,-filtering,-etc">Retrieving indices, filtering, etc</a><a id="Retrieving-indices,-filtering,-etc-1"></a><a class="docs-heading-anchor-permalink" href="#Retrieving-indices,-filtering,-etc" title="Permalink"></a></h2><p>If only the indices of the atoms are of interest, the Julia <code>findall</code> function can be used, by passing a <code>Select</code> object, or a regular  function, to select the atoms:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein and residue &lt;= 3&quot;);

julia&gt; findall(Select(&quot;name CA&quot;), atoms)
3-element Vector{Int64}:
  5
 15
 26

julia&gt; findall(at -&gt; name(at) == &quot;CA&quot;, atoms)
3-element Vector{Int64}:
  5
 15
 26</code></pre><div class="admonition is-info" id="Note-b0c2b36b5ffc5d6e"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b0c2b36b5ffc5d6e" title="Permalink"></a></header><div class="admonition-body"><p>All indexing is 1-based. Thus, the first atom of the structure is atom 1.</p></div></div><p>The <code>Select</code> constructor can be used to feed simple selection syntax entries to  other Julia functions, such as <code>findfirst</code>, <code>findlast</code>, or <code>filter</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein and residue &lt;= 3&quot;);

julia&gt; filter(Select(&quot;name CA&quot;), atoms)
   Vector{Atom{Nothing}} with 3 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       5   CA     ALA     A        1        1   -8.483  -14.912   -6.726  1.00  0.00     1    PROT         5
      15   CA     CYS     A        2        2   -5.113  -13.737   -5.466  1.00  0.00     1    PROT        15
      26   CA     ASP     A        3        3   -3.903  -11.262   -8.062  1.00  0.00     1    PROT        26

julia&gt; findfirst(Select(&quot;beta = 0.00&quot;), atoms)
1</code></pre><div class="admonition is-success" id="Tip-30e80636f34c21e5"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-30e80636f34c21e5" title="Permalink"></a></header><div class="admonition-body"><p>The <code>sel&quot;&quot;</code> literal string macro is a shortcut for <code>Select</code>. Thus, these syntaxes are valid:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; atoms = read_pdb(PDBTools.TESTPDB, &quot;protein and residue &lt;= 3&quot;);

julia&gt; name.(filter(sel&quot;name CA&quot;, atoms))
3-element Vector{InlineStrings.String7}:
 &quot;CA&quot;
 &quot;CA&quot;
 &quot;CA&quot;

julia&gt; findfirst(sel&quot;name CA&quot;, atoms)
5</code></pre></div></div><h2 id="Use-Julia-functions-directly"><a class="docs-heading-anchor" href="#Use-Julia-functions-directly">Use Julia functions directly</a><a id="Use-Julia-functions-directly-1"></a><a class="docs-heading-anchor-permalink" href="#Use-Julia-functions-directly" title="Permalink"></a></h2><p>Selections can be done using Julia functions directly, providing a greater control over the selection and, possibly, the use of user defined selection  functions. For example:</p><pre><code class="language-julia hljs">myselection(atom) = (atom.x &lt; 10.0 &amp;&amp; atom.resname == &quot;GLY&quot;) || (atom.name == &quot;CA&quot;) 
atoms = select(atoms, myselection)</code></pre><p>or, for example, using Julia anonymous functions</p><pre><code class="language-julia hljs">select(atoms, at -&gt; isprotein(at) &amp;&amp; name(at) == &quot;O&quot; &amp;&amp; atom.x &lt; 10.0)</code></pre><p>The only requirement is that the function defining the selection receives an <code>PDBTools.Atom</code> as input, and returns <code>true</code> or <code>false</code> depending on the conditions required for the atom.</p><div class="admonition is-info" id="Note-574020794f81780c"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-574020794f81780c" title="Permalink"></a></header><div class="admonition-body"><p>The macro-keywords described in the previous section can be used within  the Julia function syntax, but the function names start with <code>is</code>. For example:</p><pre><code class="language-julia hljs">select(atoms, at -&gt; isprotein(at) &amp;&amp; resnum(at) in [ 1, 5, 7 ])</code></pre><p>Thus, the macro selection functions are: <code>iswater</code>,  <code>isprotein</code>,     <code>isbackbone</code>,    <code>issidechain</code>, <code>isacidic</code>,      <code>isbasic</code>,                   <code>isaliphatic</code>,   <code>isaromatic</code>,                <code>ischarged</code>,     <code>isneutral</code>,                 <code>ispolar</code>,       <code>isnonpolar</code>,                and <code>ishydrophobic</code>.                          </p></div></div><h2 id="Using-VMD"><a class="docs-heading-anchor" href="#Using-VMD">Using VMD</a><a id="Using-VMD-1"></a><a class="docs-heading-anchor-permalink" href="#Using-VMD" title="Permalink"></a></h2><p><a href="https://www.ks.uiuc.edu/Research/vmd/">VMD</a> is a very popular and powerful package for visualization of simulations. It contains a very versatile library to read topologies and trajectory files, and a powerful selection syntax. We provide here a wrapper to VMD which enables using its capabilities.  </p><div class="admonition is-warning" id="Warning-b1fe4faf2fc1891"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-b1fe4faf2fc1891" title="Permalink"></a></header><div class="admonition-body"><p>Some notable differences of the <code>PDBTools.select</code> function relative to the selection syntax of VMD are:</p><ul><li>VMD uses 0-based indexing. Thus, the first atom is atom 0 for VMD, and  atom 1 for PDBTools. Same for residue numbering. Be careful.</li><li>VMD uses <code>resid</code> for the residue number as written in the PDB file, while PDBTools uses <code>residue</code>. </li><li>VMD uses <code>residue</code> for the sequential number of the residue in the  PDB file, while PDBTools uses <code>resnum</code>.</li></ul></div></div><p>The <code>select_with_vmd</code> input can be a vector of <code>PDBTools.Atom</code>s, or a filename. If the input is a vector of <code>Atom</code>s, the output will be the corresponding atoms matching the selection. If the input is a filename, two lists are returned: the list of indices and names of the corresponding atoms. This is because some input files supported by VMD (e. g. <code>GRO</code>, <code>PSF</code>, etc.) do not contain full atom information. </p><p>For example, here some atoms are selected from a previously loaded vector of atoms:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; pdbfile = PDBTools.SMALLPDB

julia&gt; atoms = read_pdb(pdbfile);

julia&gt; selected_atoms = select_with_vmd(atoms,&quot;resname ALA and name HT2 HT3&quot;;vmd=&quot;/usr/bin/vmd&quot;)
   Vector{Atom{Nothing}} with 2 atoms with fields:
   index name resname chain   resnum  residue        x        y        z occup  beta model segname index_pdb
       3  HT2     ALA     A        1        1   -9.488  -13.913   -5.295  0.00  0.00     1    PROT         3
       4  HT3     ALA     A        1        1   -8.652  -15.208   -4.741  0.00  0.00     1    PROT         4</code></pre><p>And, now, we provide the filename as input:</p><pre><code class="language-julia-repl hljs">julia&gt; selected_atoms = select_with_vmd(pdbfile,&quot;resname ALA and name HT2 HT3&quot;;vmd=&quot;/usr/bin/vmd&quot;)
([3, 4], [&quot;HT2&quot;, &quot;HT3&quot;])</code></pre><p>Note that in the above examples we use <code>name HT2 HT3</code> which is not currently supported by the  internal PDBTools <code>select</code> function, which would require <code>name HT2 or name HT3</code>. </p><p>Here, the output will contain two lists, one of atom indices (one-based) and atom names. The indices correspond to sequential indices in the input, <em>not</em> the indices written in the PDB file, for example.</p><div class="admonition is-success" id="Tip-cdf7b523e004e805"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-cdf7b523e004e805" title="Permalink"></a></header><div class="admonition-body"><p>If <code>vmd</code> is available in your path, there is no need to pass it as a keyword parameter.</p></div></div><p>The main advantage here is that all the file types and the complete selection syntax  that VMD supports are supported. But VMD needs to be installed and is run in background, and it takes a few seconds to run.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.select_with_vmd" href="#PDBTools.select_with_vmd"><code>PDBTools.select_with_vmd</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select_with_vmd(atoms::AbstractVector{&lt;:Atom}, selection::String; vmd=&quot;vmd&quot;, srcload=nothing)
select_with_vmd(inputfile::String, selection::String; vmd=&quot;vmd&quot;, srcload=nothing)</code></pre><p>Select atoms using vmd selection syntax, with vmd in background. The input can be a file or a list of atoms.</p><p><strong>Input structure and output format:</strong></p><ul><li><code>atoms::AbstractVector{&lt;:Atom}</code>: A vector of <code>PDBTools.Atom</code> objects to select from. In this case, the output will be a vector of <code>PDBTools.Atom</code> objects that match the selection.</li><li><code>inputfile::String</code>: Path to the input file (e.g., PDB, PSF, GRO, etc.) or a temporary file containing atom data. In this case, two vectors will be returned: one with the indices of the selected atoms and another with their names.</li></ul><p><em>The outputs are different in each case because <code>VMD</code> supports selections on files like PSF, GRO, etc., which do not  carry the full atom information like PDB files do.</em></p><p><strong>Additional arguments:</strong></p><ul><li><code>selection::String</code>: A string containing the selection criteria in VMD syntax, e.g., <code>&quot;protein and residue 1&quot;</code>.</li><li><code>vmd::String</code>: The command to run VMD. Default is <code>&quot;vmd&quot;</code>, but can be set to the full path if VMD is not in the system PATH.</li><li><code>srcload::Union{Nothing, AbstractString, Vector{AbstractString}}</code>: A script or a list of VMD scripts to load before executing the selection, for example with macros to define custom selection keywords.</li></ul><div class="admonition is-warning" id="Warning-777257b4fcb22b8f"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-777257b4fcb22b8f" title="Permalink"></a></header><div class="admonition-body"><p>VMD uses 0-based indexing, be careful to account for this when using indices in the selection string. If you want to suppress this warning, set <code>index_warning=false</code> in the function call.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/1a8fc23ecd0484965087d88354666a2f358b3468/src/select/select_with_vmd.jl#L1-L30">source</a></section></article><h3 id="Loading-vmd-scripts"><a class="docs-heading-anchor" href="#Loading-vmd-scripts">Loading vmd scripts</a><a id="Loading-vmd-scripts-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-vmd-scripts" title="Permalink"></a></h3><p>The <code>select_with_vmd</code> function also accepts an optional keyword parameter <code>srcload</code>, which can be used to load custom scripts within <code>vmd</code> before running setting the selection. This enables the definition of <code>tcl</code> scripts with custom selection macros, for instance. The usage would be: </p><pre><code class="language-julia hljs">sel = select_with_vmd(&quot;file.pdb&quot;, &quot;resname MYRES&quot;; srcload = [ &quot;mymacros1.tcl&quot;, &quot;mymacros2.tcl&quot; ])</code></pre><p>Which corresponds to <code>source</code>ing each of the macro files in VMD before defining the  selection with the custom <code>MYRES</code> name.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../readwrite/">« Read and Write</a><a class="docs-footer-nextpage" href="../iterators/">Iterators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 24 October 2025 12:11">Friday 24 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
