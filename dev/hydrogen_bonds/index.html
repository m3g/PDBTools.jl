<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hydrogen bonds · PDBTools.jl</title><meta name="title" content="Hydrogen bonds · PDBTools.jl"/><meta property="og:title" content="Hydrogen bonds · PDBTools.jl"/><meta property="twitter:title" content="Hydrogen bonds · PDBTools.jl"/><meta name="description" content="Documentation for PDBTools.jl."/><meta property="og:description" content="Documentation for PDBTools.jl."/><meta property="twitter:description" content="Documentation for PDBTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="PDBTools.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PDBTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../readwrite/">Read and Write</a></li><li><a class="tocitem" href="../selections/">Selections</a></li><li><a class="tocitem" href="../iterators/">Iterators</a></li><li><a class="tocitem" href="../elements/">Atom and element properties</a></li><li><a class="tocitem" href="../contacts/">Contact maps</a></li><li><a class="tocitem" href="../dihedrals/">Dihderals and Ramachandran</a></li><li class="is-active"><a class="tocitem" href>Hydrogen bonds</a></li><li><a class="tocitem" href="../sasa/">Solvent Accessible Area</a></li><li><a class="tocitem" href="../auxiliary/">Auxiliary functions</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../help/">Help entries</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Hydrogen bonds</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hydrogen bonds</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/m3g/PDBTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/m3g/PDBTools.jl/blob/main/docs/src/hydrogen_bonds.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hydrogen-bond-analysis"><a class="docs-heading-anchor" href="#Hydrogen-bond-analysis">Hydrogen-bond analysis</a><a id="Hydrogen-bond-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrogen-bond-analysis" title="Permalink"></a></h1><p>This tool provides a fast and practical way to compute hydrogen bonds in structures (if the structures contain hydrogen atoms).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PDBTools.hydrogen_bonds" href="#PDBTools.hydrogen_bonds"><code>PDBTools.hydrogen_bonds</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hydrogen_bonds(atoms, sel, sel1 =&gt; sel2, ... ; kargs...)</code></pre><p>Function to find hydrogen bonds in a set of atoms, or among two sets of atoms. The structure must  contain Hydrogen atoms.</p><p><strong>Arguments</strong></p><ul><li><code>atoms</code>: Vector of atoms, or structure component (model, chain, segment, residue) to be analyzed.</li></ul><p>and, optionally, the selections or selection pairs for which the hydrogen bonds must be computed:</p><ul><li><code>sel::String</code>: Selection string, e. g. <code>&quot;protein&quot;</code>.</li><li><code>sel1 =&gt; sel2::Pair{String,String}</code>: Pair of selection strings, e. g. <code>&quot;resname ARG&quot; =&gt; &quot;resname GLU&quot;</code>.</li></ul><p>The two selections of each pair, if different, must not have overalpping atoms (and error will the thrown). If no selection is provided, the hydrogen bonds of the complete structure will be computed.</p><p><strong>Optional keyword arguments</strong></p><ul><li><code>unitcell::Union{Nothing,AbstractVecOrMat}=nothing</code>: Unit cell for periodic boundary conditions.</li><li><code>donnor_acceptor_distance::Real=3.5f0</code>: Maximum distance between donnor and acceptor to consider a hydrogen bond.</li><li><code>angle_cutoff::Real=30</code>: Maximum angle (in degrees) between donnor-hydrogen-acceptor to consider a hydrogen bond.</li><li><code>electronegative_elements=(&quot;N&quot;, &quot;O&quot;, &quot;F&quot;, &quot;S&quot;)</code>: Elements considered electronegative for hydrogen bonding.</li><li><code>d_covalent_bond::Real=1.2f0</code>: Maximum distance between donnor and hydrogen to consider a covalent bond.</li><li><code>parallel::Bool=false</code>: Whether to use parallel computation.</li></ul><p><strong>Returns</strong></p><ul><li><code>HBonds</code>: A data structure containing the found hydrogen bonds, where each element is  a named tuple <code>(D, H, A, r, ang)</code> where the fields correspond to the donnor, hydrogen and acceptor atoms, the distance between donnor and acceptor atoms, and the angle. </li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; pdb = read_pdb(PDBTools.test_dir*&quot;/hbonds.pdb&quot;, &quot;model 1&quot;);

julia&gt; uc = read_unitcell(PDBTools.test_dir*&quot;/hbonds.pdb&quot;);

julia&gt; hbs = hydrogen_bonds(pdb, &quot;protein&quot;; unitcell=uc) # Single set of atoms: selection is optional
OrderedCollections.OrderedDict{String, PDBTools.HBonds} with 1 entry:
  &quot;protein =&gt; protein&quot; =&gt; HBonds(Int32[1, 1, 271, 37, 1020, 237, 56, 76, 1060, 204  …  748, 813, 828, 871, 863, 877, 96…

julia&gt; hbs[&quot;protein =&gt; protein&quot;] # Summary
HBonds data structure with 63 hydrogen-bonds.
    First hbond: (D-H---A) = (D = 1, H = 2, A = 286, r = 2.6871147f0, ang = 10.643958f0)
    Last hbond: (D-H---A) = (D = 1014, H = 1017, A = 1032, r = 2.5816715f0, ang = 12.714139f0)
    - r is the distance between Donnor and Acceptor atoms (D-A)
    - ang is the angle (degrees) between H-D and A-D.

julia&gt; hbs[&quot;protein =&gt; protein&quot;][1] # first h-bond
(D = 1, H = 2, A = 286, r = 2.6871147f0, ang = 10.643958f0)

julia&gt; hbs = hydrogen_bonds(pdb, &quot;protein&quot;, &quot;protein&quot; =&gt; &quot;resname SOL&quot;; unitcell=uc) # Multiple selections
OrderedCollections.OrderedDict{String, PDBTools.HBonds} with 2 entries:
  &quot;protein =&gt; protein&quot;     =&gt; HBonds(Int32[1, 1, 271, 37, 1020, 237, 56, 76, 1060, 204  …  748, 813, 828, 871, 863, 877…
  &quot;protein =&gt; resname SOL&quot; =&gt; HBonds(Int32[1406, 1583, 1799, 2027, 789, 3503, 1169, 184, 3914, 4304  …  1224, 38768, 12…

julia&gt; hbs[&quot;protein =&gt; protein&quot;]
HBonds data structure with 63 hydrogen-bonds.
    First hbond: (D-H---A) = (D = 1, H = 2, A = 286, r = 2.6871147f0, ang = 10.643958f0)
    Last hbond: (D-H---A) = (D = 1014, H = 1017, A = 1032, r = 2.5816715f0, ang = 12.714139f0)
    - r is the distance between Donnor and Acceptor atoms (D-A)
    - ang is the angle (degrees) between H-D and A-D.

julia&gt; hbs[&quot;protein =&gt; resname SOL&quot;]
HBonds data structure with 138 hydrogen-bonds.
    First hbond: (D-H---A) = (D = 1406, H = 1407, A = 160, r = 2.9361732f0, ang = 6.771988f0)
    Last hbond: (D-H---A) = (D = 41798, H = 41800, A = 395, r = 2.6894214f0, ang = 10.623453f0)
    - r is the distance between Donnor and Acceptor atoms (D-A)
    - ang is the angle (degrees) between H-D and A-D.</code></pre><div class="admonition is-info" id="Note-816a44f3b2c261bc"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-816a44f3b2c261bc" title="Permalink"></a></header><div class="admonition-body"><p>This function does not use topology information. It identified polar hydrogens based on distance criteria only, where <code>d_covalent_bond</code> is the criterium for identifying covalent bonds between donnor and hydrogen atoms.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/m3g/PDBTools.jl/blob/edf8acbbcf0e41d1a00db269d03315c85050406c/src/tools/hydrogen_bonds.jl#L298-L376">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dihedrals/">« Dihderals and Ramachandran</a><a class="docs-footer-nextpage" href="../sasa/">Solvent Accessible Area »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 29 October 2025 13:47">Wednesday 29 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
